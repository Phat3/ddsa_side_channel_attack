#run as sage -python sage_poc.py

from sage.all import *

p = 0x85d3893a462613b9e6a5f4b9365dacb4ce4794e2ad0fa44b94b25fa2b38cd0c62060366e3232dde22fcf9effccc67b460161f56fb0ae906deed2e707e5314943e0a62ae3f0e58c9b22cc6572abd8216a380e56754922066170d22922db8fcc570becb3e86c9fc8d59561f5f38612bed93e351c74f3b3e95ef7b08e75177bfe0b
q = 0xd8f32fa84496017348195e6e4d28a79429162277
g = 0x707a0476606b09804318b3e0fabf8f87454ce4d8af1986940e7467ff3af2026ba2c0cd240296ce0e40b515b15f008c20d3cf84288a5c7645220738fde0ec8c86083e92954b49b4320a89e659504ec1ee0a4be1c560eef29f9ee47f094bed99ef53c1cafa1dda245856878088349cc34443021af2856833f60e777dab11e9a718
x = 0x5a7e46a5d3b91ffe9a9be2017c17824b68a7da05

msg = 0xe44f3364019d18a151cab7072b5a40bb5b3e274f

r_right = 0x3f4467eef1b9e8374652f8b082a4e7ef77d6b292
s_right = 0xd648720382ed6a916114254c21f42cac441bfd93
r_tilda = 0x23e1f054a000f028252647a1ab76b0a1e2361367
s_tilda = 0x1479e2399647e21813b19251cbc3b400d09a611c

#try to reconstruct the private key from the known params
x_guess = mod ( msg * (s_tilda - s_right) ,q ) * mod( Integer(r_tilda*s_right - s_tilda*r_right)**-1, q)

print(x_guess == x)

